# first get the factors
n = 12400607165090104525057498825576429042080669317387281221346279651195782812193786824216310465835175634398725543629075359418414630251704185041070962835003337
n_2 = 153775058062884038863062002772280139902415818985385193238207061730886582613355716356019037369389154120914817173005564092023992818433151832179416224280641347233390103311037483276585407282265317243139806616065576523899264335158289315114975415176046599718984254262226182839002056027052811924915344830960801135569

g2 = 2
g3 = 3
g5 = 5

c2 = 129756479801107700672680344009777555979394194519756227016018351086211610169090020810330543513631277229611797680633220981355834530738294968771274113931589856454503755369969124024859539659398818609748093010876790095408117636822130486922729162035367900632863011657096499152522880225729176765569256239867288594541
c3 = 83024739719509843168538515190735628745022253428552518181621025480862122590498298703443333455314086117877313379223931413850684780410818473280351297126285097833499220717994575433253650722451555257626017362332771683290827110814931647232073508991794975312021948121813741766739376843907770871601346799211268800849
c5 = 145891423313153680986772146244851203830434136995139251724974825215449683985895879437381464824589321137278464966638057974022628242091406262549699348166807856536323457870809644520807709911135242908002928138171019046050444264125727711332733170209775675636562137602940927337424171483283975578234808874145997473005

from pwn import *
# factorisation done on factordb
factors_n_plus_1 = [2,  67, 2917,  138923, 1842611, 263319779, 92258823306127, 130186789928939100167, 39186420818004373904055316606023574160795705294530594872940848847629525793295418227353139658337]
factors_enc = []

t = remote('chall.polygl0ts.ch', 4500)
for factor in factors_n_plus_1:
    t.sendline(b't')
    t.sendline(str(factor).encode())
    t.recvuntil(b'enc = ')
    enc = t.recvline().strip()
    enc = int(enc)
    print(enc)
    factors_enc.append(enc)
print(factors_enc)
