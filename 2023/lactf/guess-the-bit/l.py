from pwn import *
from sage.all import Integer

t = remote('lac.tf', 31190)
# parameters not even needed, the squaring is not a modulo operation
n = 43799663339063312211273714468571591746940179019655418145595314556164983756585900662541462573429625012257141409310387298658375836921310691578072985664621716240663221443527506757539532339372290041884633435626429390371850645743643273836882575180662344402698999778971350763364891217650903860191529913028504029597794358613653479290767790778510701279503128925407744958108039428298936189375732992781717888915493080336718221632665984609704015735266455668556495869437668868103607888809570667555794011994982530936046877122373871458757189204379101886886020141036227219889443327932080080504040633414853351599120601270071913534530651
a = 6

for i in range(150):
    t.recvuntil(b'c =  ')
    c = t.recvlineS().strip()
    print(f'runde {i}: {c=}')
    sqrtable = Integer(c).nth_root(2, True)[1]
    t.sendline(b'0') if sqrtable else t.sendline(b'1')
print(t.recvallS())

# lactf{sm4ll_pla1nt3xt_sp4ac3s_ar3n't_al4ways_e4sy}
